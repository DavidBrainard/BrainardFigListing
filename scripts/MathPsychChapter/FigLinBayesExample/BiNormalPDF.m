function pdf = BiNormalPDF(x,y,u,K)% Evaluate bivariate normal PDF%% Syntax:%    pdf = BiNormalPDF(x,y,u,K)%% Description:%    Evaluate the bivariate normal pdf function.%%    This was written long ago, before Matlab provided%    a funtion that does the same thing.% % Inputs:%    x, y    - Vectors. The x and y coordinates at which to evaluate the%              pdf.   %    u       - Two dimensional column vector. The mean of the distribution.%    K       - Two-by-two matrix. The covariance matrix of the%              distribution.%% Outputs:%    pdf     - The returned pdf values. The PDF is returned in a matrix%              such that pdf(i,j) is the pdf evaluated at x(i) and y(j).% History%    xx/xx/9x dhb  Wrote it sometime in the early 1990s.%    07/12/21 dhb  Added header comments.m = length(x);n = length(y);pdf = zeros(m,n);Kdet = det(K);Kinv = inv(K);for i = 1:m  for j = 1:n    vec = [x(i) y(j)]';    z = vec-u;    pdf(i,j) = exp( -0.5*z'*Kinv*z );  endendpdf = 1/(2*pi)*1/(sqrt(Kdet))*pdf;